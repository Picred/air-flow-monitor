 Container logstash  Running
 Container ingestion_manager  Created
Attaching to ingestion_manager
ingestion_manager  | INFO:ingestion_manager:API_KEY is set ðŸ‘Œ
ingestion_manager  | INFO:ingestion_manager:Logstash is ready!
ingestion_manager  | INFO:ingestion_manager:Starting data ingestion process...
ingestion_manager  | INFO:ingestion_manager:This is not a demo. Real data will be retrieved. It may take a while. ðŸ•’
ingestion_manager  | INFO:ingestion_manager:Retrieving data of major cities of Italy...
ingestion_manager  | INFO:ingestion_manager:Retrieving data for Rome...
ingestion_manager  | INFO:ingestion_manager:Sent to Logstash! ðŸš€
ingestion_manager  | INFO:ingestion_manager:Retrieving data for Milan...
ingestion_manager  | INFO:ingestion_manager:Sent to Logstash! ðŸš€
ingestion_manager  | INFO:ingestion_manager:Retrieving data for Naples...
ingestion_manager  | INFO:ingestion_manager:Sent to Logstash! ðŸš€
ingestion_manager  | INFO:ingestion_manager:Retrieving data for Turin...
ingestion_manager  | INFO:ingestion_manager:Sent to Logstash! ðŸš€
ingestion_manager  | INFO:ingestion_manager:Retrieving data for Palermo...
ingestion_manager  | INFO:ingestion_manager:Sent to Logstash! ðŸš€
ingestion_manager  | INFO:ingestion_manager:Retrieving data for Genoa...
ingestion_manager  | INFO:ingestion_manager:Sent to Logstash! ðŸš€
ingestion_manager  | INFO:ingestion_manager:Retrieving data for Bologna...
ingestion_manager  | INFO:ingestion_manager:Sent to Logstash! ðŸš€
ingestion_manager  | INFO:ingestion_manager:Retrieving data for Florence...
ingestion_manager  | INFO:ingestion_manager:Sent to Logstash! ðŸš€
ingestion_manager  | WARNING:urllib3.connectionpool:Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'ReadTimeoutError("HTTPSConnectionPool(host='nominatim.openstreetmap.org', port=443): Read timed out. (read timeout=1)")': /search?q=Bari&format=json&limit=1
ingestion_manager  | WARNING:urllib3.connectionpool:Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'ReadTimeoutError("HTTPSConnectionPool(host='nominatim.openstreetmap.org', port=443): Read timed out. (read timeout=1)")': /search?q=Bari&format=json&limit=1
ingestion_manager  | Traceback (most recent call last):
ingestion_manager  |   File "/usr/local/lib/python3.10/site-packages/urllib3/connectionpool.py", line 537, in _make_request
ingestion_manager  |     response = conn.getresponse()
ingestion_manager  |   File "/usr/local/lib/python3.10/site-packages/urllib3/connection.py", line 466, in getresponse
ingestion_manager  |     httplib_response = super().getresponse()
ingestion_manager  |   File "/usr/local/lib/python3.10/http/client.py", line 1375, in getresponse
ingestion_manager  |     response.begin()
ingestion_manager  |   File "/usr/local/lib/python3.10/http/client.py", line 318, in begin
ingestion_manager  |     version, status, reason = self._read_status()
ingestion_manager  |   File "/usr/local/lib/python3.10/http/client.py", line 279, in _read_status
ingestion_manager  |     line = str(self.fp.readline(_MAXLINE + 1), "iso-8859-1")
ingestion_manager  |   File "/usr/local/lib/python3.10/socket.py", line 705, in readinto
ingestion_manager  |     return self._sock.recv_into(b)
ingestion_manager  |   File "/usr/local/lib/python3.10/ssl.py", line 1307, in recv_into
ingestion_manager  |     return self.read(nbytes, buffer)
ingestion_manager  |   File "/usr/local/lib/python3.10/ssl.py", line 1163, in read
ingestion_manager  |     return self._sslobj.read(len, buffer)
ingestion_manager  | TimeoutError: The read operation timed out
ingestion_manager  | 
ingestion_manager  | The above exception was the direct cause of the following exception:
ingestion_manager  | 
ingestion_manager  | Traceback (most recent call last):
ingestion_manager  |   File "/usr/local/lib/python3.10/site-packages/urllib3/connectionpool.py", line 793, in urlopen
ingestion_manager  |     response = self._make_request(
ingestion_manager  |   File "/usr/local/lib/python3.10/site-packages/urllib3/connectionpool.py", line 539, in _make_request
ingestion_manager  |     self._raise_timeout(err=e, url=url, timeout_value=read_timeout)
ingestion_manager  |   File "/usr/local/lib/python3.10/site-packages/urllib3/connectionpool.py", line 370, in _raise_timeout
ingestion_manager  |     raise ReadTimeoutError(
ingestion_manager  | urllib3.exceptions.ReadTimeoutError: HTTPSConnectionPool(host='nominatim.openstreetmap.org', port=443): Read timed out. (read timeout=1)
ingestion_manager  | 
ingestion_manager  | The above exception was the direct cause of the following exception:
ingestion_manager  | 
ingestion_manager  | Traceback (most recent call last):
ingestion_manager  |   File "/usr/local/lib/python3.10/site-packages/requests/adapters.py", line 486, in send
ingestion_manager  |     resp = conn.urlopen(
ingestion_manager  |   File "/usr/local/lib/python3.10/site-packages/urllib3/connectionpool.py", line 877, in urlopen
ingestion_manager  |     return self.urlopen(
ingestion_manager  |   File "/usr/local/lib/python3.10/site-packages/urllib3/connectionpool.py", line 877, in urlopen
ingestion_manager  |     return self.urlopen(
ingestion_manager  |   File "/usr/local/lib/python3.10/site-packages/urllib3/connectionpool.py", line 847, in urlopen
ingestion_manager  |     retries = retries.increment(
ingestion_manager  |   File "/usr/local/lib/python3.10/site-packages/urllib3/util/retry.py", line 515, in increment
ingestion_manager  |     raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
ingestion_manager  | urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='nominatim.openstreetmap.org', port=443): Max retries exceeded with url: /search?q=Bari&format=json&limit=1 (Caused by ReadTimeoutError("HTTPSConnectionPool(host='nominatim.openstreetmap.org', port=443): Read timed out. (read timeout=1)"))
ingestion_manager  | 
ingestion_manager  | During handling of the above exception, another exception occurred:
ingestion_manager  | 
ingestion_manager  | Traceback (most recent call last):
ingestion_manager  |   File "/usr/local/lib/python3.10/site-packages/geopy/adapters.py", line 457, in _request
ingestion_manager  |     resp = self.session.get(url, timeout=timeout, headers=headers)
ingestion_manager  |   File "/usr/local/lib/python3.10/site-packages/requests/sessions.py", line 602, in get
ingestion_manager  |     return self.request("GET", url, **kwargs)
ingestion_manager  |   File "/usr/local/lib/python3.10/site-packages/requests/sessions.py", line 589, in request
ingestion_manager  |     resp = self.send(prep, **send_kwargs)
ingestion_manager  |   File "/usr/local/lib/python3.10/site-packages/requests/sessions.py", line 703, in send
ingestion_manager  |     r = adapter.send(request, **kwargs)
ingestion_manager  |   File "/usr/local/lib/python3.10/site-packages/requests/adapters.py", line 519, in send
ingestion_manager  |     raise ConnectionError(e, request=request)
ingestion_manager  | requests.exceptions.ConnectionError: HTTPSConnectionPool(host='nominatim.openstreetmap.org', port=443): Max retries exceeded with url: /search?q=Bari&format=json&limit=1 (Caused by ReadTimeoutError("HTTPSConnectionPool(host='nominatim.openstreetmap.org', port=443): Read timed out. (read timeout=1)"))
ingestion_manager  | 
ingestion_manager  | During handling of the above exception, another exception occurred:
ingestion_manager  | 
ingestion_manager  | Traceback (most recent call last):
ingestion_manager  |   File "/ingestion_manager/ingestion_manager.py", line 78, in <module>
ingestion_manager  |     asyncio.run(main())
ingestion_manager  |   File "/usr/local/lib/python3.10/asyncio/runners.py", line 44, in run
ingestion_manager  |     return loop.run_until_complete(main)
ingestion_manager  |   File "/usr/local/lib/python3.10/asyncio/base_events.py", line 649, in run_until_complete
ingestion_manager  |     return future.result()
ingestion_manager  |   File "/ingestion_manager/ingestion_manager.py", line 61, in main
ingestion_manager  |     await retrieve_and_send_data(logstash_handler=logstash_handler, csv_handler=None)
ingestion_manager  |   File "/ingestion_manager/ingestion_manager.py", line 32, in retrieve_and_send_data
ingestion_manager  |     coordinates = get_coord(city)
ingestion_manager  |   File "/ingestion_manager/utils/retrieve_data.py", line 50, in get_coord
ingestion_manager  |     location = geolocator.geocode(city)
ingestion_manager  |   File "/usr/local/lib/python3.10/site-packages/geopy/geocoders/nominatim.py", line 297, in geocode
ingestion_manager  |     return self._call_geocoder(url, callback, timeout=timeout)
ingestion_manager  |   File "/usr/local/lib/python3.10/site-packages/geopy/geocoders/base.py", line 368, in _call_geocoder
ingestion_manager  |     result = self.adapter.get_json(url, timeout=timeout, headers=req_headers)
ingestion_manager  |   File "/usr/local/lib/python3.10/site-packages/geopy/adapters.py", line 447, in get_json
ingestion_manager  |     resp = self._request(url, timeout=timeout, headers=headers)
ingestion_manager  |   File "/usr/local/lib/python3.10/site-packages/geopy/adapters.py", line 469, in _request
ingestion_manager  |     raise GeocoderUnavailable(message)
ingestion_manager  | geopy.exc.GeocoderUnavailable: HTTPSConnectionPool(host='nominatim.openstreetmap.org', port=443): Max retries exceeded with url: /search?q=Bari&format=json&limit=1 (Caused by ReadTimeoutError("HTTPSConnectionPool(host='nominatim.openstreetmap.org', port=443): Read timed out. (read timeout=1)"))
[Kingestion_manager exited with code 1
